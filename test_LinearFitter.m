close all;
clear all;

%% Test script

dt = 'single';
T = LinearFitter_types(dt);

n = 16;

x0     = cast([21.8947; 22.3465;  28.3838;   34.7610;  38.2345;  40.3326;   49.9320;  52.8765;  55.3471;    66.9827;  70.5678;  84.2795; 87.8324;  94.5885;   109.7894;  110.1020],'like',T.x);
y0     = cast([1.9;     1.6;      1.7;       1.6;      1.4;      1.8;       1.5;      1.6;      1.9;        2.1;      2.3;      2.2;     2.4;      2.3;       1.5;       2.9     ],'like',T.y);
z0     = cast([128.95;  130.5476; 133.429;   152.7622; 154.6543; 157.2374;  183.1043; 185.8765; 187.5764;   219.3985; 223.8256; 228.567; 232.7952; 233.9674;  250.7654;  267.2387],'like',T.z);
l0     = cast([1;       1;        1;         2;        2;        2;         3;        3;        3;          4;        4;        5;       5;        6;         7;          7        ],'like',T.l);


%% Algorithm
[x1, y1, z1, l1] = LinearFitter_top(x0, y0, z0, l0, T);

%% Verify results
%err_x = x1 - x0 %#ok<*NOPTS>
%err_y = y1 - y0 %#ok<*NOPTS>
%err_z = z1 - z0 %#ok<*NOPTS>
